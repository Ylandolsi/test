(()=>{"use strict";class e{tasksProject=[];static projectsCounter=0;constructor(t){this.name=t,this.id=++e.projectsCounter}setName(e){this.name=e}getId(){return this.id}getName(){return this.name}addTask(e){this.tasksProject.push(e)}getTasks(){return this.tasksProject.sort(((e,t)=>e.getPriorityInt()-t.getPriorityInt()))}getHtmlProject(){let e=document.createElement("div");e.classList.add("single-project"),e.setAttribute("id",this.id);let t=document.createElement("div");t.classList.add("checkflex");let i=document.createElement("div");i.classList.add("infos");let n=document.createElement("div");n.classList.add("project-name"),n.textContent=this.name,i.appendChild(n),t.appendChild(i);let s=document.createElement("div");return s.classList.add("icons"),s.innerHTML='<svg class="delete-project" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"/></svg>\n              <svg \n              class="edit-project" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"/></svg>',e.appendChild(t),e.appendChild(s),e}}class t{static counter=0;constructor(e,i,n,s,r){this.id=++t.counter,this.title=e,this.description=i,this.dueDate=n,this.setPriority(s),this.project=r,this.done=!1}infos(){return{id:this.id,title:this.title,description:this.description,dueDate:this.dueDate,priority:this.priority,project:this.project,done:this.done}}setTitle(e){this.title=e}setDescription(e){this.description=e}setDueDate(e){this.dueDate=e}setPriority(e){"high"==e?this.priority=1:"medium"==e?this.priority=2:"low"==e&&(this.priority=3)}setProject(e){this.project=e}setDone(){this.done=!0}togleDone(){this.done=!this.done}getTitle(){return this.title}getDescription(){return this.description}getDueDate(){return this.dueDate}getPriorityInt(){return this.priority}getProject(){return this.project}getPriorityString(){return 1==this.priority?"high":2==this.priority?"medium":3==this.priority?"low":void 0}getId(){return this.id}static getCounter(){return this.counter}getHtmlTask(){let e=document.createElement("div");e.classList.add("single-task"),e.id=this.id,e.classList.add(this.getPriorityString());let t=document.createElement("div");t.classList.add("checkflex");let i=document.createElement("input");i.setAttribute("type","checkbox"),this.done&&(i.checked=!0);let n=document.createElement("div");n.classList.add("infos"),this.done&&n.classList.add("coched");let s=document.createElement("div");s.classList.add("task-title"),s.textContent=this.title;let r=document.createElement("div");r.classList.add("task-date"),r.textContent=this.dueDate,n.appendChild(s),n.appendChild(r),t.appendChild(i),t.appendChild(n);let c=document.createElement("div");return c.classList.add("icons"),c.innerHTML='<svg class="delete-task" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"/></svg>\n              <svg \n              class="edit-task" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"/></svg>',e.appendChild(t),e.appendChild(c),e}}let i=new e("Project 1"),n=new t("task1","description1","2021-12-12","high","Project 1"),s=new t("task2","description2","2021-12-12","low","Project 1");i.addTask(n),i.addTask(s),console.log(i.getName()),console.log(n.infos()),console.log(s.infos());let r=[i],c=[n,s],o=document.getElementById("dialog project"),l=document.querySelector(".new-Project-form"),a=l.querySelector("#Project-Name-input"),d=l.querySelector(".buttons .submit"),u=l.querySelector(".buttons .cancel");function p(){""!==a.value?(d.classList.contains("cannot")&&d.classList.remove("cannot"),d.classList.contains("can")||d.classList.add("can")):(d.classList.contains("can")&&d.classList.remove("can"),d.classList.contains("cannot")||d.classList.add("cannot"))}function h(e,t){t.querySelector(".checkflex").addEventListener("click",(function(){let t=e.getName(),i=e.getId(),n=document.querySelector(".task-project-title");n.textContent=t,n.setAttribute("idproject",i);let s=e.getTasks(),r=document.querySelector(".tasks-list");r.innerHTML="",s.forEach((e=>{let t=e.getHtmlTask();r.appendChild(t);let i=t.querySelector(".delete-task"),n=t.querySelector(".edit-task");T(i),j(n)}))})),function(e,t){console.log(t);let i=t.querySelector(".delete-project"),n=t.querySelector(".edit-project");i.addEventListener("click",(function(){-1!==r.findIndex((t=>t.getId()==e.id))&&r.splice(e.id,1),document.querySelector("#Task-Project-input").querySelector(`option[value="${e.getName()}"]`).remove(),t.remove()})),n.addEventListener("click",(function(){o.showModal(),a.value=e.getName(),d.textContent="Edit",d.addEventListener("click",(function(i){if("Create"===d.textContent)return;i.preventDefault();let n=a.value,s=document.querySelector("#Task-Project-input"),r=e.getName(),c=s.querySelector(`option[value="${r}"]`);e.setName(n),t.querySelector(".project-name").textContent=n;let l=document.querySelector(".task-project-title");l.getAttribute("idproject")==e.getId()&&(l.textContent=n),c.textContent=n,c.setAttribute("value",n),o.close()}))})),u.addEventListener("click",(function(e){e.preventDefault(),o.close()}))}(e,t)}document.querySelectorAll(".single-project").forEach((e=>{let t=e.getAttribute("id");h(r.find((e=>e.getId()==t)),e)})),document.querySelector(".new-project").addEventListener("click",(function(){o.showModal(),a.value="",p(),d.textContent="Create"})),d.addEventListener("click",(function(t){if("Edit"===d.textContent||!d.classList.contains("can"))return;t.preventDefault();let i=new e(a.value),n=i.getHtmlProject();r.push(i),document.querySelector(".projects-list").appendChild(n);let s=document.querySelector("#Task-Project-input"),c=document.createElement("option");c.value=i.getName(),c.textContent=i.getName(),s.appendChild(c),h(i,n),o.close()})),a.addEventListener("input",p);let v=document.querySelector(".new-Task-form"),m=document.querySelectorAll(".delete-task"),g=document.querySelectorAll(".edit-task"),k=document.querySelector(".new-task"),y=document.querySelector(".new-Task-form .buttons .submit"),q=document.querySelector(".new-Task-form .buttons .cancel"),f=document.getElementById("dialog task");q.addEventListener("click",(function(e){e.preventDefault(),f.close()}));let S=null;function L(e,t){if(e){let e=t.getAttribute("id"),i=c.find((t=>t.getId()==e));v.querySelector("#Task-title-input").value=i.getTitle(),v.querySelector("#Task-Notes-input").value=i.getDescription(),v.querySelector("#Task-Date-input").value=i.getDueDate(),v.querySelector("#Task-Priority-input").value=i.getPriorityString(),v.querySelector("#Task-Project-input").value=i.getProject(),y.textContent="Edit"}else v.querySelector("#Task-title-input").value="",v.querySelector("#Task-Notes-input").value="",v.querySelector("#Task-Date-input").value="",v.querySelector("#Task-Priority-input").value="",v.querySelector("#Task-Project-input").value="",y.textContent="Create";f.showModal();const i=Array.from(v.querySelectorAll("input[required], select[required]"));function n(){let e=!0;i.forEach((t=>{(!t.value||"date"===t.type&&""===t.value||"select"===t.tagName.toLowerCase()&&""===t.value)&&(e=!1)})),e?(y.classList.contains("cannot")&&y.classList.remove("cannot"),y.classList.contains("can")||y.classList.add("can")):(y.classList.contains("can")&&y.classList.remove("can"),y.classList.contains("cannot")||y.classList.add("cannot"))}y.classList.contains("cannot")||y.classList.add("cannot"),n(),i.forEach((e=>{"select"===e.tagName.toLowerCase()?e.addEventListener("change",n):e.addEventListener("input",n)}))}function T(e){e.addEventListener("click",(function(t){t.preventDefault(),S=e.parentElement.parentElement;let i=S.getAttribute("id"),n=(c.find((e=>e.getId()==i)),document.querySelector(".task-project-title").getAttribute("idproject")),s=r.find((e=>e.getId()==n)),o=s.tasksProject.findIndex((e=>e.getId()==i));-1!==o&&s.tasksProject.splice(o,1),S.remove()}))}function j(e){e.addEventListener("click",(function(t){t.preventDefault(),S=e.parentElement.parentElement,L(!0,S)}))}m.forEach((e=>{T(e)})),g.forEach((e=>{j(e)})),k.addEventListener("click",(function(){L(!1,null)})),y.addEventListener("click",(function(e){if(!y.classList.contains("can")||"Create"===y.textContent)return void e.preventDefault();e.preventDefault();let t=S.getAttribute("id"),i=c.find((e=>e.getId()==t)),n=document.querySelector(".task-project-title").getAttribute("idproject"),s=r.find((e=>e.getId()==n)),o=s.tasksProject.find((e=>e.getId()==t)),l=v.querySelector("#Task-title-input").value,a=v.querySelector("#Task-Notes-input").value,d=v.querySelector("#Task-Date-input").value,u=v.querySelector("#Task-Priority-input").value,p=v.querySelector("#Task-Project-input").value;i.setTitle(l),i.setDescription(a),i.setDueDate(d),i.setPriority(u),i.setProject(p),o.setTitle(l),o.setDescription(a),o.setDueDate(d),o.setPriority(u),o.setProject(p);let h=S.querySelector(".task-title"),m=S.querySelector(".task-date");h.textContent=l,m.textContent=d;let g=s.getTasks(),k=document.querySelector(".tasks-list");k.innerHTML="",g.forEach((e=>{let t=e.getHtmlTask();k.appendChild(t);let i=t.querySelector(".delete-task"),n=t.querySelector(".edit-task");T(i),j(n)})),f.close()})),y.addEventListener("click",(function(e){if(!y.classList.contains("can")||"Edit"===y.textContent)return void e.preventDefault();e.preventDefault();let i=v.querySelector("#Task-title-input").value,n=v.querySelector("#Task-Notes-input").value,s=v.querySelector("#Task-Date-input").value,o=v.querySelector("#Task-Priority-input").value,l=v.querySelector("#Task-Project-input").value,a=new t(i,n,s,o,l);c.push(a);let d=document.querySelector(".task-project-title").getAttribute("idproject"),u=r.find((e=>e.getId()==d));u.addTask(a);let p=document.querySelector(".tasks-list"),h=a.getHtmlTask();p.appendChild(h);let m=h.querySelector(".delete-task"),g=h.querySelector(".edit-task");T(m),j(g);let k=u.getTasks(),q=document.querySelector(".tasks-list");q.innerHTML="",k.forEach((e=>{let t=e.getHtmlTask();q.appendChild(t);let i=t.querySelector(".delete-task"),n=t.querySelector(".edit-task");T(i),j(n)})),f.close()})),document.addEventListener("click",(function(e){if(e.target&&"checkbox"==e.target.getAttribute("type")){const t=e.target.parentElement,i=t.parentElement;if(t){const n=t.querySelector(".infos");if(n){n.classList.toggle("coched");const s=i.getAttribute("id"),r=c.find((e=>e.getId()==s));r&&r.togleDone(),e.target.checked=!e.target.checked;let o=t.querySelector('input[type="checkbox"]');o&&(o.checked=!o.checked)}}}}))})();